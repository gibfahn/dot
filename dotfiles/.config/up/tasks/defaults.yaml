# For an unofficial defaults guide, see: https://macos-defaults.com

run_if_cmd: ["/bin/sh", "-cex", '[ "$(uname)" = Darwin ] || exit 204']
run_lib: defaults
needs_sudo: true
data:
  # System Settings > Users & Groups > Login Options > Show Input menu in login window
  /Library/Preferences/com.apple.loginwindow.plist:
    showInputMenu: true

  # System Settings > Software Update > Automatically keep my mac up to date
  /Library/Preferences/com.apple.SoftwareUpdate.plist:
    AutomaticDownload: true

  # NSGlobalDomain preferences.
  ~/Library/Preferences/ByHost/.GlobalPreferences.${UP_HARDWARE_UUID}.plist:
      # Enable Tap to Click for the current user.
      com.apple.mouse.tapBehavior: 1

  ~/Library/Preferences/ByHost/com.apple.ImageCapture.${UP_HARDWARE_UUID}.plist:
      # Prevent Photos from opening automatically when devices are plugged in
      disableHotPlug: true

  NSGlobalDomain:
    # Unnatural scrolling direction (swipe down to scroll down).
    # You can force reapply this with:
    #   /System/Library/PrivateFrameworks/SystemAdministration.framework/Resources/activateSettings -u
    com.apple.swipescrolldirection: false

    # Expand save panel by default
    NSNavPanelExpandedStateForSaveMode: true
    NSNavPanelExpandedStateForSaveMode2: true

    # Expand print panel by default
    PMPrintingExpandedStateForPrint: true
    PMPrintingExpandedStateForPrint2: true

    # Always open new things in tabs (not new windows) for document based apps.
    AppleWindowTabbingMode: always

    # Maximise window when you double-click on the title bar.
    AppleActionOnDoubleClick: Maximize

    # System Settings > Keyboard > Text > Use smart quotes and dashes > disable.
    NSAutomaticDashSubstitutionEnabled: false
    NSAutomaticQuoteSubstitutionEnabled: false

    # System Settings > Keyboard > Shortcuts > Full Keyboard Access
    # Full Keyboard Access: In Windows and Dialogs, press Tab to move keyboard
    # focus between:
    #   0: Text Boxes and Lists only
    #   2: All controls
    # Set it to 2 because that's much nicer (you can close confirmation prompts
    # with the keyboard, Enter to press the blue one, tab to select between them,
    # space to press the Tab-selected one. If there are underlined letters, hold
    # Option and press the letter to choose that option.
    AppleKeyboardUIMode: 2

    # Remove delay in showing the draggable icon in window bars.
    # https://mjtsai.com/blog/2020/10/05/big-surs-hidden-document-proxy-icon/
    NSToolbarTitleViewRolloverDelay: 0

    # Finder: show all filename extensions
    AppleShowAllExtensions: true

    # Allow text selection in any QuickLook window.
    QLEnableTextSelection: 1

    # System Settings > General > Click in the scrollbar to: Jump to the spot that's clicked
    AppleScrollerPagingBehavior: 1

    # Increases trackpad tracking speed / sensitivity (SysPref max 3.0).
    com.apple.trackpad.scaling: 5

    # Disable force clicking.
    com.apple.trackpad.forceClick: false

    # System Settings > Keyboard > Text > Capitalize words automatically.
    NSAutomaticCapitalizationEnabled: true

    # System Settings > Keyboard > Text > Add full stop with double-space.
    NSAutomaticPeriodSubstitutionEnabled: true

    # Show a list when saving files.
    NavPanelFileListModeForSaveMode: 2

    # Disabled to use the multicolour accent colour.
    # System Settings > General > Accent Colour > Purple
    # AppleAccentColor = 5

    # Enable key repeat.
    # TODO(gib): Not sure if needed for Hammerspoon key repeat.
    ApplePressAndHoldEnabled: false

    # System Settings > General > Highlight Colour > Blue
    AppleAquaColorVariant: 1

    # System Settings > General > Ask to keep changes when closing documents.
    NSCloseAlwaysConfirmsChanges: true

    # System Settings > General > Close windows when quitting an app (untick == true)
    NSQuitAlwaysKeepsWindows: true

    # Enable Tap to Click for the login screen
    com.apple.mouse.tapBehavior: 1

    # Set Date format to RFC 3339 formatting, e.g. 2000-12-25
    AppleICUDateFormatStrings:
      "1": "y-MM-dd"
      "2": "y-MM-dd"
      "3": "y-MM-dd"
      "4": "EEEE, y-MM-dd"

    # System Settings > Sound Effects > Select and alert sound: Heroine.
    # Change the error sound to the drum.
    com.apple.sound.beep.sound: /System/Library/Sounds/Hero.aiff

    # UK English, with ISO 8601 Dates (https://xkcd.com/1179/)
    AppleLocale: en_GB@calendar=iso8601

    # Main language UK English, then Chinese
    AppleLanguages:
    - en-GB
    - zh-Hans-GB

    # Use metric everywhere.
    AppleMeasurementUnits: Centimeters
    AppleMetricUnits: true
    AppleTemperatureUnit: Celsius

    # Settings > Keyboard > Keyboard Shortcuts > App Shortcuts > All Applications
    NSUserKeyEquivalents:
      # Create global shortcut "Merge all windows" âŒ˜-â‡§-M
      Merge All Windows: '@$m'

    # Settings > Keyboard > Text Replacements
    # First "on" value wins.
    NSUserDictionaryReplacementItems:
    - replace: omw
      with: on my way
      on: 1
    - replace: zss
      with: You can use âŒ˜-â‡§-Enter to paste the text as a slack snippet if the output is large.
      on: 1
    - replace: '!etr'
      with: âŽ
      on: 1
    - replace: ',af'
      with: applefeedback://inbox?make_visible=1
      on: 1
    - replace: adr
      with: 19 Woodside Grange Road, North Finchley, London, N12 8TW
      on: 1
    - replace: adrs
      with: Flat 49, Shrewsbury House, 42 Cheyne Walk, London, SW3 5LW
      on: 1
    - replace: ywt
      with: Yiwen Tang
      on: 1
    - replace: mbe
      with: 07725792449
      on: 1
    - replace: atm
      with: at the moment
      on: 1
    - replace: ymmv
      with: your mileage may vary
      on: 1
    - replace: ',unflip'
      with: â”¬â”€â”¬ãƒŽ( Âº _ ÂºãƒŽ)
      on: 1
    - replace: ',tableflip'
      with: (â•¯Â°â–¡Â°)â•¯ï¸µ â”»â”â”»
      on: 1
    - replace: ',shrug'
      with: Â¯\_(ãƒ„)_/Â¯
      on: 1
    - replace: iiuc
      with: if I understand correctly
      on: 1
    - replace: '!'''
      with: '`'
      on: 1
    - replace: evt
      with: eventang93
      on: 1
    - replace: til
      with: today I learned
      on: 1
    - replace: afaik
      with: as far as I know
      on: 1
    - replace: btw
      with: by the way
      on: 1
    - replace: dw
      with: don't worry
      on: 1
    - replace: tbf
      with: to be fair
      on: 1
    - replace: idk
      with: I don't know
      on: 1
    - replace: tbd
      with: to be determined
      on: 1
    - replace: tbc
      with: to be confirmed
      on: 1
    - replace: ftr
      with: for the record
      on: 1
    - replace: ptal
      with: please take a look
      on: 1
    - replace: omw
      with: on my way
      on: 1
    - replace: iirc
      with: if I recall correctly
      on: 1
    - replace: afaict
      with: as far as I can tell
      on: 1
    - replace: nbd
      with: no big deal
      on: 1
    - replace: '!rdo'
      with: âŸ³
      on: 1
    - replace: '!und'
      with: âŸ²
      on: 1
    - replace: '!tab'
      with: â‡¥
      on: 1
    - replace: '!del'
      with: âŒ¦
      on: 1
    - replace: '!bsp'
      with: âŒ«
      on: 1
    - replace: '!esc'
      with: âŽ‹
      on: 1
    - replace: '!cps'
      with: â‡ª
      on: 1
    - replace: wdyt
      with: what do you think
      on: 1
    - replace: tbh
      with: to be honest
      on: 1
    - replace: fwiw
      with: for what it's worth
      on: 1
    - replace: lmk
      with: let me know
      on: 1
    - replace: imho
      with: in my humble opinion
      on: 1
    - replace: sgtm
      with: sounds good to me
      on: 1
    - replace: ianal
      with: I am not a lawyer
      on: 1
    - replace: aiui
      with: as I understand it
      on: 1
    - replace: imo
      with: in my opinion
      on: 1
    - replace: mbb
      with: 07707200521
      on: 1
    - replace: ',f'
      with: https://fahn.co
      on: 1
    - replace: efg
      with: evenfahn@gmail.com
      on: 1
    - replace: '!ctl'
      with: âŒƒ
      on: 1
    - replace: '!sft'
      with: â‡§
      on: 1
    - replace: '!opt'
      with: âŒ¥
      on: 1
    - replace: '!cmd'
      with: âŒ˜
      on: 1
    - replace: '!apl'
      with: ï£¿
      on: 1
    - replace: evg
      with: eventang93@gmail.com
      on: 1
    - replace: mbg
      with: 07766520802
      on: 1
    - replace: gbg
      with: gibfahn@gmail.com
      on: 1
    - replace: evf
      with: evenfahn
      on: 1
    - replace: gbf
      with: gibfahn
      on: 1
    - replace: gfa
      with: Gibson Fahnestock
      on: 1
    - ... # Keep existing shortcuts at lower priority.

  com.apple.AppleMultitouchTrackpad:

    # Click strength: Haptic feedback 0: Light 1: Medium 2: Firm
    FirstClickThreshold: 0
    SecondClickThreshold: 0

    # Silent clicking
    ActuationStrength: 0

  com.apple.TextInputMenu:
    # Keyboard > Input Sources > Show Input menu in menu bar.
    visible: true

  com.apple.LaunchServices:
    # Disable the â€œAre you sure you want to open this application?â€ dialog
    LSQuarantine: false

  com.apple.systempreferences:
    # System Settings > View >
    #   "Organise by Category" => false (default)
    #   "Organise Alphabetically" => true
    ShowAllMode: true

  com.apple.spaces:
    # Check "Displays have separate spaces" (uncheck to allow multi-screen windows).
    spans-displays: false

  com.apple.finder:
    # Display full POSIX path as Finder window title
    _FXShowPosixPathInTitle: 1
    # Use list view in all Finder windows by default
    # Four-letter codes for the other view modes: `icnv`, `clmv`, `glyv`
    FXPreferredViewStyle: Nlsv
    # Show hidden files in the finder.
    AppleShowAllFiles: 1
    # Allow Finder to be quit (hides Desktop files).
    QuitMenuItem: 1
    # Don't show Desktop icons (hide the desktop view).
    CreateDesktop: false


  com.apple.iCal:
    # Set default time for new events to 25 minutes not 60 minutes.
    Default duration in minutes for new event: 25

  org.hammerspoon.Hammerspoon:
    # Write hammerspoon config to alternate location.
    # TODO(gib): make sure we're not escaping the ~ once it's allowed by up-rs.
    MJConfigFile: ~/.config/hammerspoon/init.lua

  # https://github.com/dexterleng/vimac/
  # TODO: work out how to do HintModeShortcut and ScrollModeShortcut, which are of plist type 'data'.
  dexterleng.vimac:
    HintCharacters: tnseriaodhplfuwyq;gjvmc,x.z/bk4738291056
    ScrollSensitivity: 72
    holdSpaceHintModeActivationEnabled: false
    ScrollCharacters: h,n,e,i,d,u,G,gg

  com.apple.ActivityMonitor:
    # Show the main window when launching Activity Monitor
    OpenMainWindow: true
    # Visualize CPU usage in the Activity Monitor Dock icon
    IconType: 5
    # Show all processes in Activity Monitor
    ShowCategory: 0
    # Sort Activity Monitor results by CPU usage
    SortColumn: CPUUsage
    SortDirection: 0

  com.apple.addressbook:
    # Enable the debug menu in Address Book
    ABShowDebugMenu: true

  com.apple.DiskUtility:
    # Enable the debug menu in Disk Utility
    DUDebugMenuEnabled: true
    advanced-image-options: true

  com.apple.QuickTimePlayerX:
    # Auto-play videos when opened with QuickTime Player
    MGPlayMovieOnOpen: false

  com.apple.SoftwareUpdate:
    # Enable the automatic update check
    AutomaticCheckEnabled: true
    # Check for software updates daily, not just once per week
    ScheduleFrequency: 1
    # Download newly available updates in background
    AutomaticDownload: 1
    # Install System data files & security updates
    CriticalUpdateInstall: 1
    # Automatically download apps purchased on other Macs
    ConfigDataInstall: 1

  com.apple.commerce:
    # Turn on app auto-update
    AutoUpdate: true
    # Allow the App Store to reboot machine on macOS updates
    AutoUpdateRestartRequired: true

  com.apple.dock:
    # System Settings > Trackpad > More Gestures > App Expose > Enable
    # Swipe down with 3 fingers to see windows for current app.
    showAppExposeGestureEnabled: true

    # Dock Region to UK
    region: GB

  com.apple.assistant.support:
    # System Settings > Keyboard > Dictation > On
    "Dictation Enabled": true

  com.apple.controlcenter:
    # Show battery percentage in menu bar.
    BatteryShowPercentage: true

    # Make sure the relevant items from the Control Center are visible.
    "NSStatusItem Visible WiFi": true
    "NSStatusItem Visible Battery": true
    "NSStatusItem Visible Clock": true


  com.apple.Safari:
    # Safari > General > Safari opens with > All non-private windows from last session
    AlwaysRestoreSessionAtLaunch: true

    ExcludePrivateWindowWhenRestoringSessionAtLaunch: true

    # Safari > General > New windows open with > Empty page
    NewTabBehavior: 1

    # Safari > General > New tabs open with > Empty page
    NewWindowBehavior: 1

    # Safari > General > Remove history items > Manually
    HistoryAgeInDaysLimit: 36500

    # Safari > Tabs > Open pages in tabs instead of windows > Always
    TabCreationPolicy: 2

    # Safari > Advanced > Show full website address
    ShowFullURLInSmartSearchField: true

    # Hides the toolbar when Safari is full-screen (hide everything but the page).
    # Safari > View > Always show toolbar in Full Screen > Unchecked
    AutoShowToolbarInFullScreen: true

    # Safari > Advanced > Show Develop menu in menu bar
    IncludeDevelopMenu: true
    WebKitDeveloperExtrasEnabledPreferenceKey: true
    WebKitPreferences.developerExtrasEnabled: true

    # Enable the Web Inspector in Safari
    com.apple.Safari.ContentPageGroupIdentifier.WebKit2DeveloperExtrasEnabled: true

  # Set Menu Bar date format: https://www.unicode.org/reports/tr35/tr35-dates.html#Date_Field_Symbol_Table
  # Note that only some formats are allowed. This shows: day of the week, date, time with seconds.
  com.apple.menuextra.clock:
    DateFormat: "EEE d MMM  HH:mm:ss"

    # Show the smallest clock we can, as we use Dato for time.
    ShowDayOfWeek: false
    ShowDayOfMonth: false
    IsAnalog: true

    # Force the clock to a specific date and time.
    # Refs: https://robservatory.com/a-problem-of-time-with-big-sur-screencasts/
    # ForceClock: "2007:01:09:09:41"

  com.apple.mail:

    # Mail > Preferences > Viewing > Show Message Headers > Custom
    CustomHeaders:
    - List-ID
    - Message-ID
    - X-Member-Count

    # Mail > Preferences > Viewing > Show most recent message at the top
    ConversationViewSortDescending: true

    # Mail > Preferences > Composing > Automatically CC Myself.
    ReplyToSelf: true

    # Mail > Preferences > Composing > When quoting text in replies or forwards > Include all the original message text.
    AlwaysIncludeOriginalMessage: true
    # Mail > Edit > Attachments > Include Original Attachments in Reply
    IncludeOriginalAttachments: true

    # Copy email addresses as `foo@example.com` instead of `Foo Bar <foo@example.com>` in Mail.app
    AddressesIncludeNameOnPasteboard: false

    # Settings > Keyboard > Keyboard Shortcuts > App Shortcuts > Mail.app
    # Requires com.apple.custommenu.apps setting, see that domain in this file.
    NSUserKeyEquivalents:
      # Mail: âŒ˜-b moves to Archive.
      Archive: '@b'
      # Mail: âŒ˜-u sends the message.
      Send: '@u'

  com.apple.mail-shared:
    # Mail > Preferences > Composing > Mark addresses not ending with (checkbox):
    AlertForNonmatchingDomains: true

    # Mail > Preferences > Composing > Mark addresses not ending with (addresses not to mark):
    DomainForMatching:
    - "@apple.com"
    - "@group.apple.com"

  com.apple.Maps:
    # Avoid tolls by default.
    MapsDefaultAvoidTollsKey: true

  com.apple.Siri:
    # Don't show Siri icon in the menu bar.
    StatusMenuVisible: false

  # https://sindresorhus.com/dato
  com.sindresorhus.Dato:
    showTimeInMenuBar: true
    showWeekNumberInMenu: false
    showCalendarInMenu: false
    showAmPm: false
    showDayOfWeekInMenu: false
    showWeekNumberInMenuBar: false
    showTimeZonesInMenu: true
    showMonthInMenuBar: true
    showSecondsInMenuBar: true
    showDateInMenu: false
    iconInMenuBar: none
    enabledCalendars: []
    # See https://nsdateformatter.com for docs.
    # e.g. 2021-11-12 Fri 13:43:02
    dateTimeFormat: "yyyy-MM-dd E HH:mm:ss"
    timeZonesInMenuBackup: []
    showDateInMenuBar: true
    timeZonesInMenu:
      - "{\"timeZone\":\"Asia\\/Shanghai\",\"menuBarTitle\":\"\",\"id\":\"6F4DAB8E-524A-45BB-BB97-EBD1AEB547EE\",\"notes\":\"\",\"isInMenuBar\":false,\"timeFormat\":\"system\",\"name\":\"ðŸ‡¨ðŸ‡³ China\",\"originalName\":\"Beijing\"}"
      - "{\"timeZone\":\"America\\/New_York\",\"menuBarTitle\":\"\",\"id\":\"5D935EF6-867C-4634-B346-D53E3313D065\",\"notes\":\"\",\"isInMenuBar\":false,\"timeFormat\":\"system\",\"name\":\"ðŸ—½ New York City\",\"originalName\":\"New York City\"}"
      - "{\"timeZone\":\"America\\/Los_Angeles\",\"menuBarTitle\":\"\",\"id\":\"45987DD3-E7DF-4329-8516-85462AC0B8B1\",\"notes\":\"\",\"isInMenuBar\":false,\"timeFormat\":\"system\",\"name\":\"ðŸŒ San Francisco\",\"originalName\":\"San Francisco\"}"
    showAddEventButtonInMenu: false
    showTimeInMenu: false
    showWeekDayInMenuBar: true

  # https://github.com/hluk/CopyQ
  com.copyq.copyq:
    Options.clipboard_notification_lines: 3
    Options.always_on_top: true
    Options.tray_items: 10
    Options.activate_item_with_single_click: true
    Options.confirm_exit: false
    Options.item_popup_interval: 3
    Options.maxitems: 9999

    # Two tabs, second one called Images
    Tabs.2.name: Images
    Tabs.2.store_items: true
    Tabs.size: 2
    Tabs.2.max_item_count: 0
    Tabs.2.icon: ""
    Options.tabs:
      - "&clipboard"
      - Images

  com.apple.universalaccess:
    # System Settings > Accessibility > Zoom > Use scroll gesture with modifer keys to zoom > Enabled
    closeViewScrollWheelToggle: true
    # Follow the keyboard focus while zoomed in
    closeViewZoomFollowsFocus: true
    # Set global or app-specific Keyboard Shortcuts.
    # To add your own:
    # - Add them in System Settings > Keyboard > Shortcuts > App Shortcuts
    # - Find them in the output of: `defaults find NSUserKeyEquivalents`
    #   Modifiers: @command, ~option, ^ctrl, $shift
    # - Add the `<com.apple.app>: NSUserKeyEquivalents: <Menu item>: <shortcut>` mapping
    #   - For global shortcuts use NSGlobalDomain.
    # - Add the `<com.apple.app>` name to this dict (`com.apple.universalaccess:
    # com.apple.custommenu.apps: ["<com.apple.app>"]`). You don't need to add NSGlobalDomain.
    com.apple.custommenu.apps:
    - com.apple.mail
    - ... # Preserve existing entries.
